{"ast":null,"code":"import _slicedToArray from \"/Users/Pallavi/metaphor/news-summarizer/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"/Users/Pallavi/metaphor/news-summarizer/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport { parse, SelectorType } from \"css-what\";\nimport boolbase from \"boolbase\";\nimport sortRules, { isTraversal } from \"./sort.js\";\nimport { compileGeneralSelector } from \"./general.js\";\nimport { ensureIsTag, PLACEHOLDER_ELEMENT } from \"./pseudo-selectors/subselects.js\";\n/**\n * Compiles a selector to an executable function.\n *\n * @param selector Selector to compile.\n * @param options Compilation options.\n * @param context Optional context for the selector.\n */\nexport function compile(selector, options, context) {\n  var next = compileUnsafe(selector, options, context);\n  return ensureIsTag(next, options.adapter);\n}\nexport function compileUnsafe(selector, options, context) {\n  var token = typeof selector === \"string\" ? parse(selector) : selector;\n  return compileToken(token, options, context);\n}\nfunction includesScopePseudo(t) {\n  return t.type === SelectorType.Pseudo && (t.name === \"scope\" || Array.isArray(t.data) && t.data.some(function (data) {\n    return data.some(includesScopePseudo);\n  }));\n}\nvar DESCENDANT_TOKEN = {\n  type: SelectorType.Descendant\n};\nvar FLEXIBLE_DESCENDANT_TOKEN = {\n  type: \"_flexibleDescendant\"\n};\nvar SCOPE_TOKEN = {\n  type: SelectorType.Pseudo,\n  name: \"scope\",\n  data: null\n};\n/*\n * CSS 4 Spec (Draft): 3.4.1. Absolutizing a Relative Selector\n * http://www.w3.org/TR/selectors4/#absolutizing\n */\nfunction absolutize(token, _ref, context) {\n  var adapter = _ref.adapter;\n  // TODO Use better check if the context is a document\n  var hasContext = !!(context === null || context === void 0 ? void 0 : context.every(function (e) {\n    var parent = adapter.isTag(e) && adapter.getParent(e);\n    return e === PLACEHOLDER_ELEMENT || parent && adapter.isTag(parent);\n  }));\n  var _iterator = _createForOfIteratorHelper(token),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var t = _step.value;\n      if (t.length > 0 && isTraversal(t[0]) && t[0].type !== SelectorType.Descendant) {\n        // Don't continue in else branch\n      } else if (hasContext && !t.some(includesScopePseudo)) {\n        t.unshift(DESCENDANT_TOKEN);\n      } else {\n        continue;\n      }\n      t.unshift(SCOPE_TOKEN);\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n}\nexport function compileToken(token, options, context) {\n  var _a;\n  token.forEach(sortRules);\n  context = (_a = options.context) !== null && _a !== void 0 ? _a : context;\n  var isArrayContext = Array.isArray(context);\n  var finalContext = context && (Array.isArray(context) ? context : [context]);\n  // Check if the selector is relative\n  if (options.relativeSelector !== false) {\n    absolutize(token, options, finalContext);\n  } else if (token.some(function (t) {\n    return t.length > 0 && isTraversal(t[0]);\n  })) {\n    throw new Error(\"Relative selectors are not allowed when the `relativeSelector` option is disabled\");\n  }\n  var shouldTestNextSiblings = false;\n  var query = token.map(function (rules) {\n    if (rules.length >= 2) {\n      var _rules = _slicedToArray(rules, 2),\n        first = _rules[0],\n        second = _rules[1];\n      if (first.type !== SelectorType.Pseudo || first.name !== \"scope\") {\n        // Ignore\n      } else if (isArrayContext && second.type === SelectorType.Descendant) {\n        rules[1] = FLEXIBLE_DESCENDANT_TOKEN;\n      } else if (second.type === SelectorType.Adjacent || second.type === SelectorType.Sibling) {\n        shouldTestNextSiblings = true;\n      }\n    }\n    return compileRules(rules, options, finalContext);\n  }).reduce(reduceRules, boolbase.falseFunc);\n  query.shouldTestNextSiblings = shouldTestNextSiblings;\n  return query;\n}\nfunction compileRules(rules, options, context) {\n  var _a;\n  return rules.reduce(function (previous, rule) {\n    return previous === boolbase.falseFunc ? boolbase.falseFunc : compileGeneralSelector(previous, rule, options, context, compileToken);\n  }, (_a = options.rootFunc) !== null && _a !== void 0 ? _a : boolbase.trueFunc);\n}\nfunction reduceRules(a, b) {\n  if (b === boolbase.falseFunc || a === boolbase.trueFunc) {\n    return a;\n  }\n  if (a === boolbase.falseFunc || b === boolbase.trueFunc) {\n    return b;\n  }\n  return function combine(elem) {\n    return a(elem) || b(elem);\n  };\n}","map":{"version":3,"names":["parse","SelectorType","boolbase","sortRules","isTraversal","compileGeneralSelector","ensureIsTag","PLACEHOLDER_ELEMENT","compile","selector","options","context","next","compileUnsafe","adapter","token","compileToken","includesScopePseudo","t","type","Pseudo","name","Array","isArray","data","some","DESCENDANT_TOKEN","Descendant","FLEXIBLE_DESCENDANT_TOKEN","SCOPE_TOKEN","absolutize","_ref","hasContext","every","e","parent","isTag","getParent","_iterator","_createForOfIteratorHelper","_step","s","n","done","value","length","unshift","err","f","forEach","_a","isArrayContext","finalContext","relativeSelector","Error","shouldTestNextSiblings","query","map","rules","_rules","_slicedToArray","first","second","Adjacent","Sibling","compileRules","reduce","reduceRules","falseFunc","previous","rule","rootFunc","trueFunc","a","b","combine","elem"],"sources":["https://raw.githubusercontent.com/fb55/css-select/0f0725a9dfeddd2fdb54eda9656cdbab5bbf6be6/src/compile.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}